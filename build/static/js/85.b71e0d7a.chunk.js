(this["webpackJsonpmatx-react"]=this["webpackJsonpmatx-react"]||[]).push([[85],{755:function(e,t,n){"use strict";n.r(t);var a=n(7),i=n(5),r=n(171),c=n(245),s=n(300),o=n(41),l=n(1),u=n(120),d=n(11),p=n(33),j=n(47),b=n(13),f=n(710),O=n(252),x=n(288),m=n(251),h=n(174),g=n(332),v=n(66),q=n(2),w=Object(i.a)(f.a)((function(){return{}}));var y=Object(i.a)(g.TextValidator)((function(){return{width:"100%",marginBottom:"16px"}})),_=Object(i.a)(O.a)((function(e){var t=e.theme;return Object(a.a)({marginBottom:"24px",padding:"24px !important"},t.breakpoints.down("sm"),{paddingLeft:"16px !important"})})),k=Object(i.a)(r.a)((function(){return{display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}})),S=Object(i.a)("span")((function(){return{fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}})),I=window.localStorage.getItem("accessToken"),A=[{label:"Awaiting Acceptance"},{label:"Assigned to Driver"},{label:"Waste Collected"},{label:"En Route to Sorting"},{label:"En Route to Landfill"},{label:"En Route to Scrapyard/Recycling Deport"},{label:"Sorting Facility"},{label:"Handed Over"},{label:"Waste Disposed"}],z=function(e){var t=e.requisition,n=Object(l.useState)(!1),a=Object(b.a)(n,2),i=a[0],s=a[1],u=Object(l.useState)([]),f=Object(b.a)(u,2),O=f[0],z=(f[1],i&&0===O.length),C=Object(l.useState)([]),R=Object(b.a)(C,2),T=R[0],B=R[1],D=Object(l.useState)(null),E=Object(b.a)(D,2),M=E[0],V=E[1],L=Object(l.useState)(null),P=Object(b.a)(L,2),W=P[0],F=P[1],J=Object(l.useState)(null),H=Object(b.a)(J,2),N=H[0],G=H[1],K=function(){var e=Object(j.a)(Object(p.a)().mark((function e(){var n,a,i,r,c;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="/manifest/requisionId?requisition_id="+t.requision_id,e.next=4,v.a.get(n,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 4:a=e.sent,i=a.data,r=i.status,c=i.manifests,"success"===r&&V(c[0]),console.log("setManifests: "+M._id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error: "+e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){var e=[];if(z)return Object(j.a)(Object(p.a)().mark((function n(){var a,i,r,c,s;return Object(p.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("requisition.serviceProviderId: "+t.serviceProviderId),a="/users/userfield?company_id="+t.serviceProviderId,n.next=5,v.a.get(a);case 5:i=n.sent,r=i.data,c=r.status,s=r.users,"success"===c&&s.forEach((function(t){console.log("user.role: "+t.role),"driver"===t.role&&(console.log("user: "+t.name),e.push({id:t._id,name:t.name+" "+t.surname}))})),B(e),console.log("hospitalOptions: "+T),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("error: "+n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))(),function(){!1}}),[z,T]),Object(l.useEffect)((function(){K(),i||B([])}),[i]);var Q=function(){var e=Object(j.a)(Object(p.a)().mark((function e(){var n,a,i;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("manifest: "+M._id),console.log("hospitalDropdownValue.id: "+W.id),e.next=5,v.a.patch("/manifest/"+M._id,{driver_id:W.id,status:N.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 5:n=e.sent,n.data.status,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("patch_error1: "+e.t0);case 13:return e.prev=13,a="/requisition/"+t._id,e.next=17,v.a.patch(a,{driver_id:W.id,status:N.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 17:i=e.sent,i.data.status,e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),console.log("patch_error2: "+e.t1);case 25:case"end":return e.stop()}}),e,null,[[0,10],[13,22]])})));return function(){return e.apply(this,arguments)}}();return Object(q.jsx)(_,{children:Object(q.jsxs)(g.ValidatorForm,{onSubmit:Q,onError:function(){return null},children:[Object(q.jsxs)(k,{children:[Object(q.jsx)(S,{children:"Assign Driver"}),function(e){if(console.log("manifest.driver_id: "+e.driver_id),null!==e.driver_id||""!==e.driver_id)return Object(q.jsx)("small",{children:"A driver has already been assigned to this task."})}(t)]}),Object(q.jsx)(x.a,{sx:{my:3}}),Object(q.jsx)(r.a,{ml:"-5px",children:Object(q.jsx)(w,{value:N,options:A,onChange:function(e,t){console.log("ManifeststatusnewValue: "+t.label),t&&t.inputValue?G({label:t.inputValue}):G(t)},getOptionLabel:function(e){return e.label},renderInput:function(e){return Object(q.jsx)(y,Object(d.a)(Object(d.a)({},e),{},{label:"Manifest Status",variant:"outlined"}))}})}),Object(q.jsx)(r.a,{ml:"-5px",children:Object(q.jsx)(w,{open:i,options:T,loading:z,onChange:function(e,t){console.log("newValue"),console.log(t),F(t)},id:"driver",onOpen:function(){return s(!0)},onClose:function(){return s(!1)},getOptionLabel:function(e){return e.name},isOptionEqualToValue:function(e,t){return e.name===t.name},renderInput:function(e){return Object(q.jsx)(y,Object(d.a)(Object(d.a)({},e),{},{fullWidth:!0,variant:"outlined",label:"Driver",InputProps:Object(d.a)(Object(d.a)({},e.InputProps),{},{endAdornment:Object(q.jsxs)(l.Fragment,{children:[z?Object(q.jsx)(m.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})}),Object(q.jsxs)(c.a,{color:"primary",variant:"contained",type:"submit",children:[Object(q.jsx)(h.a,{children:"send"}),Object(q.jsx)(o.i,{sx:{pl:1,textTransform:"capitalize"},children:"Submit"})]})]})})},C=n(470),R=n(502),T=n(21),B=Object(i.a)(r.a)((function(){return{display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}})),D=Object(i.a)("span")((function(){return{fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}})),E=Object(i.a)("div")((function(e){var t=e.theme;return Object(a.a)({margin:"30px"},t.breakpoints.down("sm"),{margin:"16px"})}));t.default=function(){var e=Object(T.e)(),t=Object(T.f)();console.log("location.requision_id: "+e.state.requisition.requision_id);return Object(q.jsx)(l.Fragment,{children:Object(q.jsx)(E,{className:"admin-analytics",children:Object(q.jsxs)(u.a,{children:[Object(q.jsxs)(B,{children:[Object(q.jsx)(D,{children:"Requisition Information"}),Object(q.jsx)(r.a,{ml:"-5px",style:{textAlign:"right"},children:Object(q.jsx)(c.a,{color:"primary",variant:"contained",onClick:function(){return t(-1)},children:Object(q.jsx)(o.i,{sx:{pl:1,textTransform:"capitalize"},children:"Back"})})})]}),Object(q.jsxs)(s.a,{container:!0,spacing:3,children:[Object(q.jsx)(s.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(q.jsx)(C.a,{requisition:e.state.requisition})}),Object(q.jsx)(s.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:function(e){if(console.log("requisition.createManifest: "+e.createManifest),console.log("requisition.acceptRequisitions: "+e.acceptRequisitions),e.acceptRequisitions)return Object(q.jsx)(z,{requisition:e})}(e.state.requisition)})]}),function(e){if(console.log("requisition.createManifest: "+e.createManifest),e.createManifest)return Object(q.jsx)(R.a,{requisition:e})}(e.state.requisition)]})})})}}}]);