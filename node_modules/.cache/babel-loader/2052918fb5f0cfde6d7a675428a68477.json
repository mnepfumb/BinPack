{"ast":null,"code":"import _defineProperty from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,Grid,Icon,styled,FormControl,Autocomplete,CircularProgress,FormControlLabel,RadioGroup,Radio}from'@mui/material';import{Span}from'app/components/Typography';import{useState,useEffect,Fragment}from'react';import{TextValidator,ValidatorForm}from'react-material-ui-form-validator';import axios from'app/api/axios';import{useNavigate}from'react-router-dom';import FormLabel from'@mui/material/FormLabel';import SimpleCard from'app/components/SimpleCard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AutoComplete=styled(Autocomplete)(function(){return{};});var TextField=styled(TextValidator)(function(){return{width:'100%',marginBottom:'16px'};});var accessToken=window.localStorage.getItem('accessToken');var AddUserForm=function AddUserForm(){var _useState=useState({date:new Date()}),_useState2=_slicedToArray(_useState,2),formState=_useState2[0],setFormState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),hospitalOptions=_useState6[0],setHospitalOptions=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),companiesOptions=_useState8[0],setCompaniesOptions=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),hospitalDropdownValue=_useState10[0],setHospitalDropdownValue=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),companiesDropdownValue=_useState12[0],setCompaniesDropdownValue=_useState12[1];var loading=open&&hospitalOptions.length===0;var navigate=useNavigate();useEffect(function(){var active=true;if(!loading){return undefined;}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,response2,hospitals,companies;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/hospital');case 2:response=_context.sent;_context.next=5;return axios.get('/company');case 5:response2=_context.sent;hospitals=response.data.hospitals;companies=response2.data.companies;console.log(hospitals);if(active){console.log(hospitals);setHospitalOptions(hospitals);setCompaniesOptions(companies);}case 10:case\"end\":return _context.stop();}}},_callee);}))();return function(){active=false;};},[loading,hospitalOptions]);useEffect(function(){if(!open){setHospitalOptions([]);}},[open]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){var companyname,company_Id,response,status;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(event.target.role.value);companyname='';company_Id='';if(hospitalDropdownValue!==null){companyname=hospitalDropdownValue.name;company_Id=hospitalDropdownValue.hospital_id;}else if(companiesDropdownValue!==null){companyname=companiesDropdownValue.name;company_Id=companiesDropdownValue.company_id;}console.log('companyname: '+companyname);console.log('company_Id: '+company_Id);console.log(event.target.userstatus.value);_context2.prev=7;console.log('accessToken: '+accessToken);_context2.next=11;return axios.post('/users',{name:event.target.username.value,surname:event.target.surname.value,role:event.target.role.value,password:event.target.password.value,company:companyname,company_id:company_Id,is_active:event.target.userstatus.value,phone:event.target.mobile.value,email:event.target.email.value,created_date:new Date(),updated_at:new Date(),headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(accessToken)}// withCredentials: true\n});case 11:response=_context2.sent;status=response.data.status;if(status==='success'){// setOpen(true);\nnavigate('/netcare/admin/user');}_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](7);console.log('error: '+_context2.t0);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[7,16]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var ChooseCompany=function ChooseCompany(role){if(role==='hospital'){return/*#__PURE__*/_jsx(AutoComplete,{open:open,options:hospitalOptions,loading:loading,onChange:handleHospitalDropdownChange,id:\"Hospital\",onOpen:function onOpen(){return setOpen(true);},onClose:function onClose(){return setOpen(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Hospital\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}});}else if(role==='service provider'||role==='driver'){return/*#__PURE__*/_jsx(AutoComplete,{open:open,options:companiesOptions,loading:loading,onChange:handleCompaniesDropdownChange,id:\"company\",onOpen:function onOpen(){return setOpen(true);},onClose:function onClose(){return setOpen(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Service Provider\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}});}};var handleHospitalDropdownChange=function handleHospitalDropdownChange(_,newValue){console.log('newValue');console.log(newValue);setHospitalDropdownValue(newValue);};var handleCompaniesDropdownChange=function handleCompaniesDropdownChange(_,newValue){console.log('newValue');console.log(newValue);setCompaniesDropdownValue(newValue);};var handleChange=function handleChange(event){event.persist();setFormState(_objectSpread(_objectSpread({},formState),{},_defineProperty({},event.target.name,event.target.value)));};var username=formState.username,mobile=formState.mobile,surname=formState.surname,password=formState.password,confirmPassword=formState.confirmPassword,email=formState.email,role=formState.role,isActive=formState.isActive;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:handleSubmit,onError:function onError(){return null;},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:6,children:[/*#__PURE__*/_jsxs(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:[/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"username\",label:\"Name\",onChange:handleChange,value:username||'',validators:['required','minStringLength:1','maxStringLength: 100'],errorMessages:['this field is required','this field requires 100 characters','this field requires 100 characters']}),/*#__PURE__*/_jsx(TextField,{type:\"email\",name:\"email\",label:\"Email\",value:email||'',onChange:handleChange,validators:['required','isEmail'],errorMessages:['this field is required','email is not valid']}),/*#__PURE__*/_jsx(TextField,{name:\"password\",type:\"password\",label:\"Password\",value:password||'',onChange:handleChange// validators={[\"required\"]}\n// errorMessages={[\"this field is required\"]}\n}),/*#__PURE__*/_jsx(TextField,{type:\"password\",name:\"confirmPassword\",onChange:handleChange,label:\"Confirm Password\",value:confirmPassword||''// validators={[\"required\", \"isPasswordMatch\"]}\n// errorMessages={[\"this field is required\", \"password didn't match\"]}\n}),/*#__PURE__*/_jsx(SimpleCard,{children:/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",className:\"formControl\",children:[/*#__PURE__*/_jsx(FormLabel,{component:\"legend\",children:\"Would you like this user to be active\"}),/*#__PURE__*/_jsxs(RadioGroup,{value:isActive,name:\"userstatus\",className:\"userstatus\",\"aria-label\":\"User Status\",onChange:handleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:true,control:/*#__PURE__*/_jsx(Radio,{}),label:\"Active\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:false,control:/*#__PURE__*/_jsx(Radio,{}),label:\"None Active\"})]})]})})]}),/*#__PURE__*/_jsxs(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:[/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"surname\",label:\"Surname\",onChange:handleChange,value:surname||'',validators:['required','minStringLength:1','maxStringLength: 100'],errorMessages:['this field is required','this field requires 100 characters','this field requires 100 characters']}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"mobile\",value:mobile||'',label:\"Mobile Number\",onChange:handleChange,validators:['required'],errorMessages:['this field is required']}),/*#__PURE__*/_jsxs(SimpleCard,{children:[/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",className:\"formControl\",children:[/*#__PURE__*/_jsx(FormLabel,{component:\"legend\",children:\"Role\"}),/*#__PURE__*/_jsxs(RadioGroup,{value:role,name:\"role\",className:\"Role\",\"aria-label\":\"Role\",onChange:handleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:\"admin\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Admin User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"hospital\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Hospital User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"service provider\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Service Provider User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"driver\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Driver\"})]})]}),/*#__PURE__*/_jsx(Grid,{children:ChooseCompany(role)})]})]})]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",variant:\"contained\",type:\"submit\",children:[/*#__PURE__*/_jsx(Icon,{children:\"send\"}),/*#__PURE__*/_jsx(Span,{sx:{pl:1,textTransform:'capitalize'},children:\"Submit\"})]})]})});};export default AddUserForm;","map":null,"metadata":{},"sourceType":"module"}