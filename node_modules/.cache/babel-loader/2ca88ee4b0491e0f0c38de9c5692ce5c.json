{"ast":null,"code":"import _defineProperty from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{DatePicker}from\"@mui/lab\";import AdapterDateFns from\"@mui/lab/AdapterDateFns\";import LocalizationProvider from\"@mui/lab/LocalizationProvider\";import{Button,Grid,Icon,styled,Autocomplete,CircularProgress,FormControl,FormControlLabel,RadioGroup,Radio}from\"@mui/material\";import{Span}from\"app/components/Typography\";import{useEffect,useState,Fragment}from\"react\";import{TextValidator,ValidatorForm}from\"react-material-ui-form-validator\";import axios from'app/api/axios';import{useNavigate}from'react-router-dom';import SimpleCard from'app/components/SimpleCard';import FormLabel from'@mui/material/FormLabel';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TextField=styled(TextValidator)(function(){return{width:\"100%\",marginBottom:\"16px\"};});var AutoComplete=styled(Autocomplete)(function(){return{};});var accessToken=window.localStorage.getItem('accessToken');var AddRequisitionForm=function AddRequisitionForm(){var _useState=useState({date:new Date()}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];// const [formState, setFormState] = useState({ date: new Date() });\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openHospital=_useState4[0],setOpenHospital=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openCompanies=_useState6[0],setOpenCompanies=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),hospitalOptions=_useState8[0],setHospitalOptions=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),companiesOptions=_useState10[0],setCompaniesOptions=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),hospitalDropdownValue=_useState12[0],setHospitalDropdownValue=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),companiesDropdownValue=_useState14[0],setCompaniesDropdownValue=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),wasteType=_useState16[0],setWasteType=_useState16[1];var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),getDate=_useState18[0],setDate=_useState18[1];var hospital_loading=openHospital&&hospitalOptions.length===0;var companies_loading=openCompanies&&companiesOptions.length===0;var navigate=useNavigate();var handleHospitalDropdownChange=function handleHospitalDropdownChange(_,newValue){console.log('newValue');console.log(newValue);setHospitalDropdownValue(newValue);};var handleCompaniesDropdownChange=function handleCompaniesDropdownChange(_,newValue){console.log('newValue');console.log(newValue);setCompaniesDropdownValue(newValue);};var handleWasteType=function handleWasteType(_,newValue){if(newValue&&newValue.inputValue){setWasteType({label:newValue.inputValue});return;}setWasteType(newValue);};useEffect(function(){var active=true;if(!companies_loading){return undefined;}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response2,companies;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/company');case 2:response2=_context.sent;companies=response2.data.companies;if(active){setCompaniesOptions(companies);}case 5:case\"end\":return _context.stop();}}},_callee);}))();return function(){active=false;};},[companies_loading,hospitalOptions]);useEffect(function(){var active=true;if(!hospital_loading){return undefined;}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,hospitals;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/hospital');case 2:response=_context2.sent;hospitals=response.data.hospitals;if(active){setHospitalOptions(hospitals);}case 5:case\"end\":return _context2.stop();}}},_callee2);}))();return function(){active=false;};},[hospital_loading,hospitalOptions]);var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event){var response,status;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log('companiesDropdownValue.name: '+companiesDropdownValue.name);console.log('companiesDropdownValue.company_id: '+companiesDropdownValue.company_id);console.log('event.target.collection_address.value: '+event.target.collection_address.value);console.log('hospitalDropdownValue.name: '+hospitalDropdownValue.name);console.log('hospitalDropdownValue.hospital_id: '+hospitalDropdownValue.hospital_id);console.log('event.target.details.value: '+event.target.details.value);console.log('wasteType: '+wasteType.label);console.log('event.target.waste_category.value: '+event.target.waste_category.value);console.log('event.target.date.value: '+getDate);console.log('event.target.expected_qty.value: '+event.target.expected_qty.value);console.log('event.target.bin_location.value: '+event.target.bin_location.value);_context3.prev=11;console.log('accessToken: '+accessToken);_context3.next=15;return axios.post('/requisition',{serviceProviderName:companiesDropdownValue.name,serviceProviderId:companiesDropdownValue.company_id,collection_address:event.target.collection_address.value,hospitalName:hospitalDropdownValue.name,hospitalId:hospitalDropdownValue.hospital_id,details:event.target.details.value,wasteType:wasteType.label,wasteCategory:event.target.waste_category.value,collection_Date:getDate,driver_id:'',user_id:'',expected_qty:event.target.expected_qty.value,bin_location:event.target.bin_location.value,assignRequisitions:true,rejectRequisitions:false,acceptRequisitions:false,createManifest:false,percentage:0,status:'Awaiting Acceptance',created_date:new Date(),updated_at:new Date(),headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(accessToken)}// withCredentials: true\n});case 15:response=_context3.sent;status=response.data.status;if(status==='success'){// setOpen(true);\nnavigate(-1);}_context3.next=23;break;case 20:_context3.prev=20;_context3.t0=_context3[\"catch\"](11);console.log('error: '+_context3.t0);case 23:case\"end\":return _context3.stop();}}},_callee3,null,[[11,20]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var handleChange=function handleChange(event){event.persist();setState(_objectSpread(_objectSpread({},state),{},_defineProperty({},event.target.name,event.target.value)));};var hanndleWasteType=function hanndleWasteType(wasteCategory){var waste_options;console.log('waste_options: '+waste_options);console.log('wasteCategory: '+wasteCategory);if(wasteCategory==='Covid Waste'){waste_options=covid_waste;}else if(wasteCategory==='General Waste'){waste_options=general_waste;}else if(wasteCategory==='Hazardous Waste'){waste_options=hazardous_waste;}else if(wasteCategory==='Metal Waste'){waste_options=metal_waste;}else if(wasteCategory==='Paper Waste'){waste_options=paper_waste;}else if(wasteCategory==='Plastic Waste'){waste_options=plastic_waste;}else if(wasteCategory==='Refuse Waste'){waste_options=refuse_waste;}else if(wasteCategory==='Healthcare Risk Waste'){waste_options=healthcare_risk_waste;}else if(wasteCategory==='Other'){waste_options=other_waste;}console.log('waste_options: '+waste_options);if(wasteCategory!==undefined){return/*#__PURE__*/_jsx(AutoComplete,{value:wasteType,options:waste_options,onChange:handleWasteType,getOptionLabel:function getOptionLabel(option){return option.label;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Waste Type\",variant:\"outlined\"}));}});}};var handleDateChange=function handleDateChange(date){setState(_objectSpread(_objectSpread({},state),{},{date:date}));setDate(date);};var collection_address=state.collection_address,expected_qty=state.expected_qty,date=state.date,bin_location=state.bin_location,details=state.details,waste_category=state.waste_category;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:handleSubmit,onError:function onError(){return null;},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:6,children:[/*#__PURE__*/_jsxs(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:[/*#__PURE__*/_jsx(AutoComplete,{open:openHospital,options:hospitalOptions,loading:hospital_loading,onChange:handleHospitalDropdownChange,id:\"Hospital\",onOpen:function onOpen(){return setOpenHospital(true);},onClose:function onClose(){return setOpenHospital(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Hospital\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[hospital_loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}}),/*#__PURE__*/_jsx(AutoComplete,{open:openCompanies,options:companiesOptions,loading:companies_loading,onChange:handleCompaniesDropdownChange,id:\"company\",onOpen:function onOpen(){return setOpenCompanies(true);},onClose:function onClose(){return setOpenCompanies(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Service Provider\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[companies_loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}}),/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,children:/*#__PURE__*/_jsx(DatePicker,{value:date,onChange:handleDateChange,renderInput:function renderInput(props){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},props),{},{label:\"Collection Date\",id:\"collection_date\",sx:{mb:2,width:\"100%\"}}));}})}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"collection_address\",value:collection_address||\"\",label:\"Collection Address\",onChange:handleChange,validators:[\"required\"],errorMessages:[\"this field is required\"]}),/*#__PURE__*/_jsx(TextField,{name:\"bin_location\",type:\"text\",label:\"Bin Location\",value:bin_location||\"\",onChange:handleChange,validators:[\"required\"],errorMessages:[\"this field is required\"]}),/*#__PURE__*/_jsx(TextField,{name:\"expected_qty\",type:\"number\",label:\"Expected Qty (in kg's)\",value:expected_qty||\"\",onChange:handleChange,validators:[\"required\"],errorMessages:[\"this field is required\"]}),/*#__PURE__*/_jsx(TextField,{name:\"details\",type:\"text\",label:\"Details\",value:details||\"\",onChange:handleChange// validators={[\"required\"]}\n// errorMessages={[\"this field is required\"]}\n})]}),/*#__PURE__*/_jsx(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:/*#__PURE__*/_jsxs(SimpleCard,{children:[/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",className:\"formControl\",children:[/*#__PURE__*/_jsx(FormLabel,{component:\"legend\",children:\"Waste Category\"}),/*#__PURE__*/_jsxs(RadioGroup,{value:waste_category,name:\"waste_category\",className:\"Waste Category\",\"aria-label\":\"Waste Category\",onChange:handleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:\"Covid Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Covid Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"General Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"General Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Hazardous Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Hazardous Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Metal Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Metal Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Paper Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Paper Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Plastic Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Plastic Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Refuse Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Refuse Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Healthcare Risk Waste\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Healthcare Risk Waste\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Other\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Other\"})]})]}),/*#__PURE__*/_jsx(Grid,{children:hanndleWasteType(waste_category)})]})})]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",variant:\"contained\",type:\"submit\",children:[/*#__PURE__*/_jsx(Icon,{children:\"send\"}),/*#__PURE__*/_jsx(Span,{sx:{pl:1,textTransform:\"capitalize\"},children:\"Submit\"})]})]})});};// const waste_category = [\n//     { label: 'Covid Waste' },\n//     { label: 'General Waste' },\n//     { label: 'Hazardous Waste' },\n//     { label: 'Metal Waste' },\n//     { label: 'Paper Waste' },\n//     { label: 'Plastic Waste' },\n//     { label: 'Refuse Waste' },\n//     { label: 'Healthcare Risk Waste' },\n//     { label: 'Other' },\n// ];\nvar covid_waste=[{label:'Infectious Waste – Autoclave'}];var general_waste=[{label:'General Landfill SA'}];var hazardous_waste=[{label:'Fluorescent Tubes'}];var metal_waste=[{label:'Aluminium cans and foil'},{label:'Mixed Cans'},{label:'Steel Cans'}];var paper_waste=[{label:'Board'},{label:'Mixed'},{label:'Paper'}];var plastic_waste=[{label:'HDPE'},{label:'LDPE and LLDPE'},{label:'PET'},{label:'PP'},{label:'PVC'}];var refuse_waste=[{label:'Domestic Waste – Recycle'}];var healthcare_risk_waste=[{label:'Anatomical Waste – Incineration'},{label:'Cytotoxic Waste – Incineration'},{label:'Pharmaceutical Waste – Incineration'},{label:'Sharps - Autoclave'}];var other_waste=[{label:'Glass'}];export default AddRequisitionForm;","map":null,"metadata":{},"sourceType":"module"}