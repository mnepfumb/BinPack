{"ast":null,"code":"import useAuth from'app/hooks/useAuth';import{flat}from'app/utils/utils';import{Navigate,useLocation}from'react-router-dom';import AllPages from'../Routes/routes';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var userHasPermission=function userHasPermission(pathname,user,routes){console.log('AuthProvider-user: '+user.role);console.log('AuthProvider-pathname: '+pathname);console.log('AuthProvider-routes: '+routes);if(!user){return false;}else{var matched=routes.find(function(route){return route.path===pathname;});var authenticated=matched&&matched.auth&&matched.auth.length?matched.auth.includes(user.role):true;console.log('AuthProvider-matched: '+matched);console.log('AuthProvider-matched.auth: '+matched.auth);console.log('AuthProvider-matched.auth.length: '+matched.auth.length);console.log('AuthProvider-matched.auth.includes(user.role): '+matched.auth.includes(user.role));return authenticated;}};var AuthGuard=function AuthGuard(_ref){var children=_ref.children;var authenticated;var _useAuth=useAuth(),isAuthenticated=_useAuth.isAuthenticated,user=_useAuth.user;var _useLocation=useLocation(),pathname=_useLocation.pathname;// Override path\nif(user&&isAuthenticated){console.log('user: '+user.role);console.log('AuthProvider-isAuthenticated: '+isAuthenticated);console.log('pathname: '+pathname);var routes=flat(AllPages);console.log('routes: '+routes);var hasPermission=userHasPermission(pathname,user,routes);console.log('AuthProvider-hasPermission: '+hasPermission);authenticated=isAuthenticated&&hasPermission;}else{authenticated=isAuthenticated;}console.log('AuthProvider-authenticated: '+authenticated);// IF YOU NEED ROLE BASED AUTHENTICATION,\n// UNCOMMENT ABOVE LINES\n// AND COMMENT OUT BELOW authenticated VARIABLE\nreturn/*#__PURE__*/_jsx(_Fragment,{children:authenticated?children:/*#__PURE__*/_jsx(Navigate,{replace:true,to:\"/session/signin\",state:{from:pathname}})});};export default AuthGuard;","map":null,"metadata":{},"sourceType":"module"}