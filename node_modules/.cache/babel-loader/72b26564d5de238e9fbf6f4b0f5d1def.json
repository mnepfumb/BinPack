{"ast":null,"code":"import _defineProperty from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bluevisionai/Desktop/untitled folder/untitled folder/gitdagray/binpack-16-03-23/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,Grid,Icon,styled,FormControl,Autocomplete,CircularProgress,FormControlLabel,RadioGroup,Radio}from'@mui/material';import{Span}from'app/components/Typography';import{useState,useEffect,Fragment}from'react';import{TextValidator,ValidatorForm}from'react-material-ui-form-validator';import axios from'app/api/axios';import FormLabel from'@mui/material/FormLabel';import SimpleCard from'app/components/SimpleCard';import{useNavigate,useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AutoComplete=styled(Autocomplete)(function(){return{};});var TextField=styled(TextValidator)(function(){return{width:'100%',marginBottom:'16px'};});var EditUserForm=function EditUserForm(){var location=useLocation();var _useState=useState({date:new Date()}),_useState2=_slicedToArray(_useState,2),formState=_useState2[0],setFormState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var _useState5=useState([location.state.user.company]),_useState6=_slicedToArray(_useState5,2),hospitalOptions=_useState6[0],setHospitalOptions=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),companiesOptions=_useState8[0],setCompaniesOptions=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),hospitalDropdownValue=_useState10[0],setHospitalDropdownValue=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),companiesDropdownValue=_useState12[0],setCompaniesDropdownValue=_useState12[1];var loading=open&&hospitalOptions.length===0;var navigate=useNavigate();useEffect(function(){var active=true;if(!loading){return undefined;}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,hospitals;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/hospital');case 2:response=_context.sent;hospitals=response.data.hospitals;console.log(hospitals);if(active){console.log(hospitals);setHospitalOptions(hospitals);}case 6:case\"end\":return _context.stop();}}},_callee);}))();return function(){active=false;};},[loading,hospitalOptions]);useEffect(function(){if(!open){setHospitalOptions([]);}},[open]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){var isactive,companyname,company_Id,accessToken,url,response,status;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isactive=location.state.user.is_active;if(event.target.userstatus.value){isactive=event.target.userstatus.value;}companyname='';company_Id='';if(hospitalDropdownValue!==undefined){companyname=hospitalDropdownValue.name;company_Id=hospitalDropdownValue.hospital_id;}else if(companiesDropdownValue!==null){companyname=companiesDropdownValue.name;company_Id=companiesDropdownValue.company_id;}_context2.prev=5;accessToken=window.localStorage.getItem('accessToken');console.log('location.state.user._id: '+location.state.user._id);url='/users/'+location.state.user._id;console.log('url: '+url);_context2.next=12;return axios.patch(url,{name:event.target.username.value,surname:event.target.surname.value,role:event.target.role.value,company:companyname,company_id:company_Id,is_active:isactive,phone:event.target.mobile.value,email:event.target.email.value,updated_at:new Date(),headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(accessToken)}// withCredentials: true\n});case 12:response=_context2.sent;status=response.data.status;if(status==='success'){navigate('/netcare/admin/user');}_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](5);console.log('error: '+_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[5,17]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var ChooseCompany=function ChooseCompany(role){if(role==='hospital'){return/*#__PURE__*/_jsx(AutoComplete,{open:open,options:hospitalOptions,loading:loading,onChange:handleHospitalDropdownChange,id:\"Hospital\",onOpen:function onOpen(){return setOpen(true);},onClose:function onClose(){return setOpen(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Hospital\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}});}else if(role==='service provider'||role==='driver'){return/*#__PURE__*/_jsx(AutoComplete,{open:open,options:companiesOptions,loading:loading,onChange:handleCompaniesDropdownChange,id:\"company\",onOpen:function onOpen(){return setOpen(true);},onClose:function onClose(){return setOpen(false);},getOptionLabel:function getOptionLabel(option){return option.name;},isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.name===value.name;},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{fullWidth:true,variant:\"outlined\",label:\"Choose Service Provider\",InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(Fragment,{children:[loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]})})}));}});}};var handleHospitalDropdownChange=function handleHospitalDropdownChange(_,newValue){console.log('newValue');console.log(newValue);// if (newValue && newValue.inputValue) {\n// \tsetDropdownValue({ label: newValue.inputValue });\n//   return;\n// }\nsetHospitalDropdownValue(newValue);};var handleCompaniesDropdownChange=function handleCompaniesDropdownChange(_,newValue){console.log('newValue');console.log(newValue);// if (newValue && newValue.inputValue) {\n// \tsetDropdownValue({ label: newValue.inputValue });\n//   return;\n// }\nsetCompaniesDropdownValue(newValue);};var handleChange=function handleChange(event){event.persist();setFormState(_objectSpread(_objectSpread({},formState),{},_defineProperty({},event.target.name,event.target.value)));};var _formState$username=formState.username,username=_formState$username===void 0?location.state.user.name:_formState$username,_formState$mobile=formState.mobile,mobile=_formState$mobile===void 0?location.state.user.phone:_formState$mobile,_formState$surname=formState.surname,surname=_formState$surname===void 0?location.state.user.surname:_formState$surname,_formState$email=formState.email,email=_formState$email===void 0?location.state.user.email:_formState$email,_formState$role=formState.role,role=_formState$role===void 0?location.state.user.role:_formState$role,isActive=formState.isActive;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:handleSubmit,onError:function onError(){return null;},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:6,children:[/*#__PURE__*/_jsxs(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:[/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"username\",label:\"Name\",onChange:handleChange,value:username||'',validators:['required','minStringLength:1','maxStringLength: 100'],errorMessages:['this field is required','this field requires 100 characters','this field requires 100 characters']}),/*#__PURE__*/_jsx(TextField,{type:\"email\",name:\"email\",label:\"Email\",value:email||'',onChange:handleChange,validators:['required','isEmail'],errorMessages:['this field is required','email is not valid']}),/*#__PURE__*/_jsx(SimpleCard,{children:/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",className:\"formControl\",children:[/*#__PURE__*/_jsxs(FormLabel,{component:\"legend\",children:[\"Would you like this user to be active: \",location.state.user.is_active.toString()]}),/*#__PURE__*/_jsxs(RadioGroup,{value:isActive,name:\"userstatus\",className:\"userstatus\",\"aria-label\":\"User Status\",onChange:handleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:true,control:/*#__PURE__*/_jsx(Radio,{}),label:\"Active\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:false,control:/*#__PURE__*/_jsx(Radio,{}),label:\"None Active\"})]})]})})]}),/*#__PURE__*/_jsxs(Grid,{item:true,lg:6,md:6,sm:12,xs:12,sx:{mt:2},children:[/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"surname\",label:\"Surname\",onChange:handleChange,value:surname||'',validators:['required','minStringLength:1','maxStringLength: 100'],errorMessages:['this field is required','this field requires 100 characters','this field requires 100 characters']}),/*#__PURE__*/_jsx(TextField,{type:\"text\",name:\"mobile\",value:mobile||'',label:\"Mobile Number\",onChange:handleChange,validators:['required'],errorMessages:['this field is required']}),/*#__PURE__*/_jsxs(SimpleCard,{children:[/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",className:\"formControl\",children:[/*#__PURE__*/_jsx(FormLabel,{component:\"legend\",children:\"Role\"}),/*#__PURE__*/_jsxs(RadioGroup,{value:role,name:\"role\",className:\"Role\",\"aria-label\":\"Role\",onChange:handleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:\"admin\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Admin User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"hospital\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Hospital User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"service provider\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Service Provider User\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"driver\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Driver\"})]})]}),/*#__PURE__*/_jsx(Grid,{children:ChooseCompany(role)})]})]})]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",variant:\"contained\",type:\"submit\",children:[/*#__PURE__*/_jsx(Icon,{children:\"send\"}),/*#__PURE__*/_jsx(Span,{sx:{pl:1,textTransform:'capitalize'},children:\"Submit\"})]})]})});};export default EditUserForm;","map":null,"metadata":{},"sourceType":"module"}