(this.webpackJsonpBinPack=this.webpackJsonpBinPack||[]).push([[85],{752:function(e,t,n){"use strict";n.r(t);var i=n(7),a=n(5),r=n(171),c=n(245),o=n(300),s=n(41),l=n(1),u=n(120),d=n(11),p=n(33),j=n(46),b=n(13),f=n(707),O=n(252),x=n(288),m=n(251),h=n(174),g=n(332),v=n(65),q=n(2),_=Object(a.a)(f.a)((function(){return{}})),w=Object(a.a)(g.TextValidator)((function(){return{width:"100%",marginBottom:"16px"}})),y=Object(a.a)(O.a)((function(e){var t=e.theme;return Object(i.a)({marginBottom:"24px",padding:"24px !important"},t.breakpoints.down("sm"),{paddingLeft:"16px !important"})})),k=Object(a.a)(r.a)((function(){return{display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}})),S=Object(a.a)("span")((function(){return{fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}})),I=window.localStorage.getItem("accessToken"),A=[{label:"Awaiting Acceptance"},{label:"Assigned to Driver"},{label:"Waste Collected"},{label:"En Route to Sorting"},{label:"En Route to Landfill"},{label:"En Route to Scrapyard/Recycling Deport"},{label:"Sorting Facility"},{label:"Handed Over"},{label:"Waste Disposed"}],C=function(e){var t=e.requisition,n=Object(l.useState)(!1),i=Object(b.a)(n,2),a=i[0],o=i[1],u=Object(l.useState)([]),f=Object(b.a)(u,2),O=f[0],C=(f[1],a&&0===O.length),T=Object(l.useState)([]),z=Object(b.a)(T,2),B=z[0],R=z[1],P=Object(l.useState)(null),D=Object(b.a)(P,2),E=D[0],M=D[1],V=Object(l.useState)(null),L=Object(b.a)(V,2),W=L[0],F=L[1],J=Object(l.useState)(null),H=Object(b.a)(J,2),N=H[0],G=H[1];Object(l.useEffect)((function(){var e=[];if(C)return Object(j.a)(Object(p.a)().mark((function n(){var i,a,r,c,o;return Object(p.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("requisition.serviceProviderId: "+t.serviceProviderId),i="/users/userfield?company_id="+t.serviceProviderId,n.next=5,v.a.get(i,{headers:{"Content-Type":"application/json"}});case 5:a=n.sent,r=a.data,c=r.status,o=r.users,"success"===c&&o.forEach((function(t){console.log("user.role: "+t.role),"driver"===t.role&&(console.log("user: "+t.name),e.push({id:t._id,name:t.name+" "+t.surname}))})),R(e),console.log("hospitalOptions: "+B),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("error: "+n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))(),function(){}}),[C,B,t.serviceProviderId]),Object(l.useEffect)((function(){var e=function(){var e=Object(j.a)(Object(p.a)().mark((function e(){var n,i,a,r,c;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="/manifest/requisionId?requisition_id="+t.requision_id,e.next=4,v.a.get(n,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 4:i=e.sent,a=i.data,r=a.status,c=a.manifests,"success"===r&&M(c[0]),console.log("setManifests: "+E._id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error: "+e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();e(),a||R([])}),[E._id,a,t.requision_id]);var K=function(){var e=Object(j.a)(Object(p.a)().mark((function e(){var n,i,a;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("manifest: "+E._id),console.log("hospitalDropdownValue.id: "+W.id),e.next=5,v.a.patch("/manifest/"+E._id,{driver_id:W.id,status:N.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 5:n=e.sent,n.data.status,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("patch_error1: "+e.t0);case 13:return e.prev=13,i="/requisition/"+t._id,e.next=17,v.a.patch(i,{driver_id:W.id,status:N.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}});case 17:a=e.sent,a.data.status,e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),console.log("patch_error2: "+e.t1);case 25:case"end":return e.stop()}}),e,null,[[0,10],[13,22]])})));return function(){return e.apply(this,arguments)}}();return Object(q.jsx)(y,{children:Object(q.jsxs)(g.ValidatorForm,{onSubmit:K,onError:function(){return null},children:[Object(q.jsxs)(k,{children:[Object(q.jsx)(S,{children:"Assign Driver"}),function(e){if(console.log("manifest.driver_id: "+e.driver_id),null!==e.driver_id||""!==e.driver_id)return Object(q.jsx)("small",{children:"A driver has already been assigned to this task."})}(t)]}),Object(q.jsx)(x.a,{sx:{my:3}}),Object(q.jsx)(r.a,{ml:"-5px",children:Object(q.jsx)(_,{value:N,options:A,onChange:function(e,t){console.log("ManifeststatusnewValue: "+t.label),t&&t.inputValue?G({label:t.inputValue}):G(t)},getOptionLabel:function(e){return e.label},renderInput:function(e){return Object(q.jsx)(w,Object(d.a)(Object(d.a)({},e),{},{label:"Manifest Status",variant:"outlined"}))}})}),Object(q.jsx)(r.a,{ml:"-5px",children:Object(q.jsx)(_,{open:a,options:B,loading:C,onChange:function(e,t){console.log("newValue"),console.log(t),F(t)},id:"driver",onOpen:function(){return o(!0)},onClose:function(){return o(!1)},getOptionLabel:function(e){return e.name},isOptionEqualToValue:function(e,t){return e.name===t.name},renderInput:function(e){return Object(q.jsx)(w,Object(d.a)(Object(d.a)({},e),{},{fullWidth:!0,variant:"outlined",label:"Driver",InputProps:Object(d.a)(Object(d.a)({},e.InputProps),{},{endAdornment:Object(q.jsxs)(l.Fragment,{children:[C?Object(q.jsx)(m.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})}),Object(q.jsxs)(c.a,{color:"primary",variant:"contained",type:"submit",children:[Object(q.jsx)(h.a,{children:"send"}),Object(q.jsx)(s.i,{sx:{pl:1,textTransform:"capitalize"},children:"Submit"})]})]})})},T=n(467),z=n(498),B=n(21),R=Object(a.a)(r.a)((function(){return{display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}})),P=Object(a.a)("span")((function(){return{fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}})),D=Object(a.a)("div")((function(e){var t=e.theme;return Object(i.a)({margin:"30px"},t.breakpoints.down("sm"),{margin:"16px"})}));t.default=function(){var e=Object(B.e)(),t=Object(B.f)();console.log("location.requision_id: "+e.state.requisition.requision_id);return Object(q.jsx)(l.Fragment,{children:Object(q.jsx)(D,{className:"admin-analytics",children:Object(q.jsxs)(u.a,{children:[Object(q.jsxs)(R,{children:[Object(q.jsx)(P,{children:"Requisition Information"}),Object(q.jsx)(r.a,{ml:"-5px",style:{textAlign:"right"},children:Object(q.jsx)(c.a,{color:"primary",variant:"contained",onClick:function(){return t(-1)},children:Object(q.jsx)(s.i,{sx:{pl:1,textTransform:"capitalize"},children:"Back"})})})]}),Object(q.jsxs)(o.a,{container:!0,spacing:3,children:[Object(q.jsx)(o.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(q.jsx)(T.a,{requisition:e.state.requisition})}),Object(q.jsx)(o.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:function(e){if(console.log("requisition.createManifest: "+e.createManifest),console.log("requisition.acceptRequisitions: "+e.acceptRequisitions),e.acceptRequisitions)return Object(q.jsx)(C,{requisition:e})}(e.state.requisition)})]}),function(e){if(console.log("requisition.createManifest: "+e.createManifest),e.createManifest)return Object(q.jsx)(z.a,{requisition:e})}(e.state.requisition)]})})})}}}]);