(this.webpackJsonpBinPack=this.webpackJsonpBinPack||[]).push([[92],{751:function(e,t,a){"use strict";a.r(t);var i=a(5),n=a(196),s=a(265),r=a(331),c=a(40),o=a(1),l=a(133),d=a(697),j=a(273),p=a(318),u=a(272),b=a(194),m=a(344),x=a(69),h=a(2);const O=Object(i.a)(d.a)((()=>({}))),g=Object(i.a)(m.TextValidator)((()=>({width:"100%",marginBottom:"16px"}))),f=Object(i.a)(j.a)((e=>{let{theme:t}=e;return{marginBottom:"24px",padding:"24px !important",[t.breakpoints.down("sm")]:{paddingLeft:"16px !important"}}})),v=Object(i.a)(n.a)((()=>({display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}))),y=Object(i.a)("span")((()=>({fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}))),w=window.localStorage.getItem("accessToken"),q=[{label:"Awaiting Acceptance"},{label:"Assigned to Driver"},{label:"Waste Collected"},{label:"En Route to Sorting"},{label:"En Route to Landfill"},{label:"En Route to Scrapyard/Recycling Deport"},{label:"Sorting Facility"},{label:"Handed Over"},{label:"Waste Disposed"}];var S=e=>{let{requisition:t}=e;const[a,i]=Object(o.useState)(!1),[r,l]=Object(o.useState)([]),d=a&&0===r.length,[j,S]=Object(o.useState)([]),[_,I]=Object(o.useState)(null),[A,C]=Object(o.useState)(null),[T,k]=Object(o.useState)(null);Object(o.useEffect)((()=>{let e=[];if(d)return(async()=>{try{var a="/users/userfield?company_id="+t.serviceProviderId;const i=await x.a.get(a,{headers:{"Content-Type":"application/json"}}),{status:n,users:s}=i.data;"success"===n&&s.forEach((t=>{"driver"===t.role&&e.push({id:t._id,name:t.name+" "+t.surname})})),S(e)}catch(i){}})(),()=>{}}),[d,j,t.serviceProviderId]),Object(o.useEffect)((()=>{(async()=>{try{var e="/manifest/requisionId?requisition_id="+t.requision_id;const a=await x.a.get(e,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(w)}}),{status:i,manifests:n}=a.data;"success"===i&&I(n[0])}catch(a){}})(),a||S([])}),[_._id,a,t.requision_id]);return Object(h.jsx)(f,{children:Object(h.jsxs)(m.ValidatorForm,{onSubmit:async()=>{try{const e=await x.a.patch("/manifest/"+_._id,{driver_id:A.id,status:T.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(w)}}),{status:t}=e.data}catch(a){}try{var e="/requisition/"+t._id;const a=await x.a.patch(e,{driver_id:A.id,status:T.label,updated_at:new Date,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(w)}}),{status:i}=a.data}catch(a){}},onError:()=>null,children:[Object(h.jsxs)(v,{children:[Object(h.jsx)(y,{children:"Assign Driver"}),(e=>{if(null!==e.driver_id||""!==e.driver_id)return Object(h.jsx)("small",{children:"A driver has already been assigned to this task."})})(t)]}),Object(h.jsx)(p.a,{sx:{my:3}}),Object(h.jsx)(n.a,{ml:"-5px",children:Object(h.jsx)(O,{value:T,options:q,onChange:(e,t)=>{t&&t.inputValue?k({label:t.inputValue}):k(t)},getOptionLabel:e=>e.label,renderInput:e=>Object(h.jsx)(g,{...e,label:"Manifest Status",variant:"outlined"})})}),Object(h.jsx)(n.a,{ml:"-5px",children:Object(h.jsx)(O,{open:a,options:j,loading:d,onChange:(e,t)=>{C(t)},id:"driver",onOpen:()=>i(!0),onClose:()=>i(!1),getOptionLabel:e=>e.name,isOptionEqualToValue:(e,t)=>e.name===t.name,renderInput:e=>Object(h.jsx)(g,{...e,fullWidth:!0,variant:"outlined",label:"Driver",InputProps:{...e.InputProps,endAdornment:Object(h.jsxs)(o.Fragment,{children:[d?Object(h.jsx)(u.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}})})}),Object(h.jsxs)(s.a,{color:"primary",variant:"contained",type:"submit",children:[Object(h.jsx)(b.a,{children:"send"}),Object(h.jsx)(c.i,{sx:{pl:1,textTransform:"capitalize"},children:"Submit"})]})]})})},_=a(443),I=a(471),A=a(9);const C=Object(i.a)(n.a)((()=>({display:"flex",paddingLeft:"24px",paddingRight:"24px",marginBottom:"12px",alignItems:"center",justifyContent:"space-between"}))),T=Object(i.a)("span")((()=>({fontSize:"1rem",fontWeight:"500",textTransform:"capitalize"}))),k=Object(i.a)("div")((e=>{let{theme:t}=e;return{margin:"30px",[t.breakpoints.down("sm")]:{margin:"16px"}}}));t.default=()=>{const e=Object(A.m)(),t=Object(A.o)();return Object(h.jsx)(o.Fragment,{children:Object(h.jsx)(k,{className:"admin-analytics",children:Object(h.jsxs)(l.a,{children:[Object(h.jsxs)(C,{children:[Object(h.jsx)(T,{children:"Requisition Information"}),Object(h.jsx)(n.a,{ml:"-5px",style:{textAlign:"right"},children:Object(h.jsx)(s.a,{color:"primary",variant:"contained",onClick:()=>t(-1),children:Object(h.jsx)(c.i,{sx:{pl:1,textTransform:"capitalize"},children:"Back"})})})]}),Object(h.jsxs)(r.a,{container:!0,spacing:3,children:[Object(h.jsx)(r.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:Object(h.jsx)(_.a,{requisition:e.state.requisition})}),Object(h.jsx)(r.a,{item:!0,lg:6,md:6,sm:12,xs:12,children:(e=>{if(e.acceptRequisitions)return Object(h.jsx)(S,{requisition:e})})(e.state.requisition)})]}),(e=>{if(e.createManifest)return Object(h.jsx)(I.a,{requisition:e})})(e.state.requisition)]})})})}}}]);